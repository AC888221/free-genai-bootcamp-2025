/usr/lib/python3.10/importlib/util.py:247: DeprecationWarning: The `openvino.runtime` module is deprecated and will be removed in the 2026.0 release. Please replace `openvino.runtime` with `openvino`.
  self.__spec__.loader.exec_module(self)
INFO 03-12 01:16:42 api_server.py:712] vLLM API server version 0.6.6.post1
INFO 03-12 01:16:42 api_server.py:713] args: Namespace(host='0.0.0.0', port=8008, uvicorn_log_level='info', allow_credentials=False, allowed_origins=['*'], allowed_methods=['*'], allowed_headers=['*'], api_key=None, lora_modules=None, prompt_adapters=None, chat_template=None, chat_template_content_format='auto', response_role='assistant', ssl_keyfile=None, ssl_certfile=None, ssl_ca_certs=None, ssl_cert_reqs=0, root_path=None, middleware=[], return_tokens_as_token_ids=False, disable_frontend_multiprocessing=False, enable_request_id_headers=False, enable_auto_tool_choice=False, tool_call_parser=None, tool_parser_plugin='', model='Qwen/Qwen2.5-0.5B-Instruct', task='auto', tokenizer=None, skip_tokenizer_init=False, revision=None, code_revision=None, tokenizer_revision=None, tokenizer_mode='auto', trust_remote_code=True, allowed_local_media_path=None, download_dir=None, load_format='auto', config_format=<ConfigFormat.AUTO: 'auto'>, dtype='float32', kv_cache_dtype='auto', quantization_param_path=None, max_model_len=2048, guided_decoding_backend='xgrammar', logits_processor_pattern=None, distributed_executor_backend=None, worker_use_ray=False, pipeline_parallel_size=1, tensor_parallel_size=1, max_parallel_loading_workers=None, ray_workers_use_nsight=False, block_size=None, enable_prefix_caching=None, disable_sliding_window=False, use_v2_block_manager=True, num_lookahead_slots=0, seed=0, swap_space=4, cpu_offload_gb=0, gpu_memory_utilization=0.9, num_gpu_blocks_override=None, max_num_batched_tokens=2048, max_num_seqs=None, max_logprobs=20, disable_log_stats=False, quantization=None, rope_scaling=None, rope_theta=None, hf_overrides=None, enforce_eager=False, max_seq_len_to_capture=8192, disable_custom_all_reduce=False, tokenizer_pool_size=0, tokenizer_pool_type='ray', tokenizer_pool_extra_config=None, limit_mm_per_prompt=None, mm_processor_kwargs=None, disable_mm_preprocessor_cache=False, enable_lora=False, enable_lora_bias=False, max_loras=1, max_lora_rank=16, lora_extra_vocab_size=256, lora_dtype='auto', long_lora_scaling_factors=None, max_cpu_loras=None, fully_sharded_loras=False, enable_prompt_adapter=False, max_prompt_adapters=1, max_prompt_adapter_token=0, device='auto', num_scheduler_steps=1, multi_step_stream_outputs=True, scheduler_delay_factor=0.0, enable_chunked_prefill=None, speculative_model=None, speculative_model_quantization=None, num_speculative_tokens=None, speculative_disable_mqa_scorer=False, speculative_draft_tensor_parallel_size=None, speculative_max_model_len=None, speculative_disable_by_batch_size=None, ngram_prompt_lookup_max=None, ngram_prompt_lookup_min=None, spec_decoding_acceptance_method='rejection_sampler', typical_acceptance_sampler_posterior_threshold=None, typical_acceptance_sampler_posterior_alpha=None, disable_logprobs_during_spec_decoding=None, model_loader_extra_config=None, ignore_patterns=[], preemption_mode=None, served_model_name=None, qlora_adapter_name_or_path=None, otlp_traces_endpoint=None, collect_detailed_traces=None, disable_async_output_proc=False, scheduling_policy='fcfs', override_neuron_config=None, override_pooler_config=None, compilation_config=None, kv_transfer_config=None, worker_cls='auto', generation_config=None, disable_log_requests=False, max_log_len=None, disable_fastapi_docs=False, enable_prompt_tokens_details=False)
INFO 03-12 01:16:42 api_server.py:199] Started engine process with PID 43
INFO 03-12 01:16:46 config.py:2268] Upcasting torch.bfloat16 to torch.float32.
/usr/lib/python3.10/importlib/util.py:247: DeprecationWarning: The `openvino.runtime` module is deprecated and will be removed in the 2026.0 release. Please replace `openvino.runtime` with `openvino`.
  self.__spec__.loader.exec_module(self)
INFO 03-12 01:16:53 config.py:510] This model supports multiple tasks: {'generate', 'classify', 'score', 'embed', 'reward'}. Defaulting to 'generate'.
WARNING 03-12 01:16:53 config.py:642] Async output processing is not supported on the current platform type openvino.
WARNING 03-12 01:16:53 openvino.py:82] CUDA graph is not supported on OpenVINO backend, fallback to the eager mode.
INFO 03-12 01:16:53 openvino.py:116] OpenVINO CPU optimal block size is 32, overriding currently set 16
WARNING 03-12 01:16:53 openvino.py:131] Environment variable VLLM_OPENVINO_KVCACHE_SPACE (GB) for OpenVINO backend is not set, using 4 by default.
INFO 03-12 01:16:58 config.py:2268] Upcasting torch.bfloat16 to torch.float32.
INFO 03-12 01:17:05 config.py:510] This model supports multiple tasks: {'reward', 'generate', 'embed', 'classify', 'score'}. Defaulting to 'generate'.
WARNING 03-12 01:17:05 config.py:642] Async output processing is not supported on the current platform type openvino.
WARNING 03-12 01:17:05 openvino.py:82] CUDA graph is not supported on OpenVINO backend, fallback to the eager mode.
INFO 03-12 01:17:05 openvino.py:116] OpenVINO CPU optimal block size is 32, overriding currently set 16
WARNING 03-12 01:17:05 openvino.py:131] Environment variable VLLM_OPENVINO_KVCACHE_SPACE (GB) for OpenVINO backend is not set, using 4 by default.
INFO 03-12 01:17:05 llm_engine.py:234] Initializing an LLM engine (v0.6.6.post1) with config: model='Qwen/Qwen2.5-0.5B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-0.5B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.float32, max_seq_len=2048, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=<Type: 'float16'>, quantization_param_path=None, device_config=cpu, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-0.5B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=False, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=True, 
INFO 03-12 01:17:08 openvino.py:33] Cannot use _Backend.FLASH_ATTN backend on OpenVINO.
INFO 03-12 01:17:08 selector.py:145] Using OpenVINO Attention backend.
WARNING 03-12 01:17:08 _custom_ops.py:19] Failed to import from vllm._C with ModuleNotFoundError("No module named 'vllm._C'")
WARNING 03-12 01:17:08 openvino.py:114] Provided model id Qwen/Qwen2.5-0.5B-Instruct does not contain OpenVINO IR, the model will be converted to IR with default options. If you need to use specific options for model conversion, use optimum-cli export openvino with desired options.
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
/usr/local/lib/python3.10/dist-packages/transformers/cache_utils.py:460: TracerWarning: Using len to get tensor shape might cause the trace to be incorrect. Recommended usage would be tensor.shape[0]. Passing a tensor of different shape might lead to errors or silently give incorrect results.
  or len(self.key_cache[layer_idx]) == 0  # the layer has no cache
/usr/local/lib/python3.10/dist-packages/optimum/exporters/openvino/model_patcher.py:515: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!
  if sequence_length != 1:
/usr/local/lib/python3.10/dist-packages/transformers/cache_utils.py:444: TracerWarning: Using len to get tensor shape might cause the trace to be incorrect. Recommended usage would be tensor.shape[0]. Passing a tensor of different shape might lead to errors or silently give incorrect results.
  len(self.key_cache[layer_idx]) == 0
INFO 03-12 01:17:54 openvino_executor.py:69] OpenVINO CPU: # device blocks: 10922; # swap blocks: 0
INFO 03-12 01:17:57 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 3.12 seconds
INFO 03-12 01:17:58 api_server.py:640] Using supplied chat template:
INFO 03-12 01:17:58 api_server.py:640] None
INFO 03-12 01:17:58 launcher.py:19] Available routes are:
INFO 03-12 01:17:58 launcher.py:27] Route: /openapi.json, Methods: HEAD, GET
INFO 03-12 01:17:58 launcher.py:27] Route: /docs, Methods: HEAD, GET
INFO 03-12 01:17:58 launcher.py:27] Route: /docs/oauth2-redirect, Methods: HEAD, GET
INFO 03-12 01:17:58 launcher.py:27] Route: /redoc, Methods: HEAD, GET
INFO 03-12 01:17:58 launcher.py:27] Route: /health, Methods: GET
INFO 03-12 01:17:58 launcher.py:27] Route: /tokenize, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /detokenize, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /v1/models, Methods: GET
INFO 03-12 01:17:58 launcher.py:27] Route: /version, Methods: GET
INFO 03-12 01:17:58 launcher.py:27] Route: /v1/chat/completions, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /v1/completions, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /v1/embeddings, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /pooling, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /score, Methods: POST
INFO 03-12 01:17:58 launcher.py:27] Route: /v1/score, Methods: POST
/usr/local/lib/python3.10/dist-packages/websockets/legacy/__init__.py:6: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
  warnings.warn(  # deprecated in 14.0 - 2024-11-09
/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/websockets/websockets_impl.py:17: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
  from websockets.server import WebSocketServerProtocol
INFO:     Started server process [11]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8008 (Press CTRL+C to quit)
INFO:     172.18.0.4:42454 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:42456 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:54846 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:47494 - "GET /health HTTP/1.1" 200 OK
INFO 03-12 02:39:54 chat_utils.py:333] Detected the chat template content format to be 'string'. You can set `--chat-template-content-format` to override this.
/usr/local/lib/python3.10/dist-packages/vllm/entrypoints/openai/serving_engine.py:303: DeprecationWarning: max_tokens is deprecated in favor of the max_completion_tokens field
  max_tokens = request.max_completion_tokens or request.max_tokens
/usr/local/lib/python3.10/dist-packages/vllm/entrypoints/openai/protocol.py:400: DeprecationWarning: max_tokens is deprecated in favor of the max_completion_tokens field
  max_tokens = self.max_completion_tokens or self.max_tokens
INFO 03-12 02:39:54 logger.py:37] Received request chatcmpl-a06e54217783446c9e0f9e5af8f75a26: prompt: '<|im_start|>system\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\n<|im_start|>user\nhi there<|im_end|>\n<|im_start|>assistant\n', params: SamplingParams(n=1, presence_penalty=0.0, frequency_penalty=0.0, repetition_penalty=1.0, temperature=0.7, top_p=1.0, top_k=-1, min_p=0.0, seed=None, stop=[], stop_token_ids=[], bad_words=[], include_stop_str_in_output=False, ignore_eos=False, max_tokens=1000, min_tokens=0, logprobs=None, prompt_logprobs=None, skip_special_tokens=True, spaces_between_special_tokens=True, truncate_prompt_tokens=None, guided_decoding=None), prompt_token_ids: None, lora_request: None, prompt_adapter_request: None.
INFO 03-12 02:39:54 engine.py:267] Added request chatcmpl-a06e54217783446c9e0f9e5af8f75a26.
WARNING 03-12 02:39:56 openvino.py:58] Pin memory is not supported on OpenViNO.
INFO 03-12 02:39:56 metrics.py:467] Avg prompt throughput: 3.1 tokens/s, Avg generation throughput: 0.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%.
INFO:     172.18.0.4:56600 - "POST /v1/chat/completions HTTP/1.1" 200 OK
INFO:     172.18.0.4:37146 - "GET /health HTTP/1.1" 200 OK
INFO 03-12 02:40:07 metrics.py:467] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.8 tokens/s, Running: 0 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%.
INFO 03-12 02:40:17 metrics.py:467] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 0 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%.
INFO:     172.18.0.4:57384 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:46036 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:33370 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:50300 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:42242 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:54576 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:56480 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:41688 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:60930 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:60940 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:40840 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:40856 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:43748 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:35714 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:41528 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:55870 - "GET /health HTTP/1.1" 200 OK
INFO:     172.18.0.4:37038 - "GET /health HTTP/1.1" 200 OK
